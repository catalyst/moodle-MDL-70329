define("core/local/filter/filtertypes/discrimination",["exports","core/form-autocomplete","core/local/filter/range","core/local/filter/selectors","core/templates","core/str"],(function(_exports,_formAutocomplete,_range,_selectors,_templates,_str){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Discrimination index filter.
   *
   * @module     core/local/filter/filtertypes/discrimination
   * @copyright  2022 Ghaly Marc-Alexandre <marc-alexandreghaly@catalyst-ca.net>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_formAutocomplete=_interopRequireDefault(_formAutocomplete),_range=_interopRequireDefault(_range),_selectors=_interopRequireDefault(_selectors),_templates=_interopRequireDefault(_templates);const INTERPRETATION={VALUES:{"Very good discrimination":1,"Adequate discrimination":2,"Weak discrimination":3,"Very weak discrimination":4,"Question probably invalid":5},RANGES:{1:"49",2:"30-49",3:"20-29",4:"0-19",5:"0"}};class _default extends _range.default{constructor(filterType,filterSet,initialValues,filterRange){super(filterType,filterSet,initialValues,filterRange),this.interpretation=!1,this.filterType=filterType,this.setUpRangeUi("number",initialValues).then((()=>{this.displayRadio()})).catch()}displayRadio(){const filterRange=this.rootNode.querySelector(_selectors.default.filter.regions.rangeByName(this.filterType)),filterInterpretation=document.createElement("div");filterInterpretation.setAttribute("data-filterregion","interpretation"),_templates.default.render("qbank_statistics/discrimination_index_radio",{}).then((html=>{filterInterpretation.innerHTML=html,filterRange.parentNode.insertBefore(filterInterpretation,filterRange)})).then((()=>{this.discriminationRadioListenner()})).catch()}async discriminationRadioListenner(){const placeholderOne=await this.placeholderOne,placeholderTwo=await this.placeholderTwo,interpretationPlaceholder=await this.interpretationPlaceholder,filterRange=this.filterRoot.querySelector(_selectors.default.filter.regions.rangeByName(this.filterType));document.getElementById("discriminationselect").addEventListener("change",(e=>{if("interpretation"===e.target.value){filterRange.setAttribute("class","d-none"),this.interpretation=!0;const dataSource=this.filterRoot.querySelector("#rangeValue1"),inputHide=document.getElementById("rangeValue2");null!==inputHide&&inputHide.setAttribute("class","d-none");for(const[key,value]of Object.entries(INTERPRETATION.VALUES)){let selectedOption;selectedOption=document.createElement("option"),selectedOption.value=value,selectedOption.innerHTML=key,dataSource.append(selectedOption)}_formAutocomplete.default.enhance(dataSource,!1,null,interpretationPlaceholder,!1,!0,null,!0,{layout:"core/local/filter/autocomplete_layout",selection:"core/local/filter/autocomplete_selection"})}if("index"===e.target.value){filterRange.removeAttribute("class"),this.interpretation=!1;const context={placeholderone:placeholderOne,type:"number"};2===this.rangetype&&(context.placeholdertwo=placeholderTwo),this.displayRange(context)}}))}get placeholderOne(){return(0,_str.get_string)("firstplaceholder","qbank_statistics")}get placeholderTwo(){return(0,_str.get_string)("secondplaceholder","qbank_statistics")}get interpretationPlaceholder(){return(0,_str.get_string)("interpretationplaceholder","qbank_statistics")}get selectedOption(){return this.filterRoot.querySelector("div[data-active-value]").dataset.activeValue}get interpretationRanges(){const range=INTERPRETATION.RANGES[this.selectedOption].split("-");return[range[0],range[1]]}get rawValues(){if(!0===this.interpretation)return 1==this.selectedOption||5==this.selectedOption?[this.interpretationRanges[0]]:this.interpretationRanges;const values=[document.getElementById("rangeValue1").value];if(2===this.rangetype){const rangeValue2=document.getElementById("rangeValue2").value;values.push(rangeValue2)}return values}get rangetype(){if(!0===this.interpretation){if(1==this.selectedOption)return 0;if(5==this.selectedOption)return 1}return parseInt(this.filterRoot.querySelector(_selectors.default.filter.fields.range).value,10)}}return _exports.default=_default,_exports.default}));

//# sourceMappingURL=discrimination.min.js.map